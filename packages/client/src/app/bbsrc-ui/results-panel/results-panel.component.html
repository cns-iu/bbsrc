<mat-expansion-panel #panel>
  <mat-expansion-panel-header>
    <mat-panel-title>
      <mat-spinner *ngIf="numResults === -1" [diameter]="18"></mat-spinner>
      <span *ngIf="numResults >= 0">
        {{ numResults | number }} Results
      </span>
    </mat-panel-title>
    <mat-panel-description>
      {{description}}
    </mat-panel-description>
  </mat-expansion-panel-header>

  <div class="table">
    <mat-table [dataSource]="processedData">
      <ng-container matColumnDef="author">
        <mat-header-cell *matHeaderCellDef>
          {{authorField?.field.label}}
        </mat-header-cell>
        <mat-cell *matCellDef="let data">
          {{data[0]}}
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="year">
        <mat-header-cell *matHeaderCellDef>
          {{yearField?.field.label}}
        </mat-header-cell>
        <mat-cell *matCellDef="let data">
          {{data[1] || 'â€“'}}
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="title">
        <mat-header-cell *matHeaderCellDef>
          {{titleField?.field.label}}
        </mat-header-cell>
        <mat-cell *matCellDef="let data">
          {{data[2]}}
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="link">
        <mat-header-cell *matHeaderCellDef>
          {{linkField?.field.label}}
        </mat-header-cell>
        <mat-cell *matCellDef="let data">
          <a *ngIf="data[3].pmid" [attr.href]="pubMedHref(data[3].pmid)" target="_blank">
            PubMed
          </a>

          <a *ngIf="data[3].doi" [attr.href]="doiHref(data[3].doi)" target="_blank">
            DOI
          </a>

          <a *ngIf="data[3].gtr" [attr.href]="gtrHref(data[3].gtr)" target="_blank">
            GTR
          </a>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="journal">
        <mat-header-cell *matHeaderCellDef>
          {{journalField?.field.label}}
        </mat-header-cell>
        <mat-cell *matCellDef="let data">
          {{data[4]}}
        </mat-cell>
      </ng-container>

      <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
      <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
    </mat-table>
  </div>
</mat-expansion-panel>
